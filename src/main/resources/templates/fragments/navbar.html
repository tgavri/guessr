<!-- Navbar -->
<style>
    .navbar-brand {
        font-weight: 600;
        font-size: 24px;
    }
    .navbar-logo {
        height: 60px; /* Adjust this value as needed */
        width: auto;  /* Keep the aspect ratio */
    }
         /* Modal Styling */
     #loginModal {
         display: none; /* Hidden by default */
         position: fixed;
         z-index: 1050;
         left: 0;
         top: 0;
         width: 100%;
         height: 100%;
         overflow: auto;
         background-color: rgba(0, 0, 0, 0.8); /* Semi-transparent background */
     }
    .modal-content {
        background: linear-gradient(135deg, #bc9aff, #c4d1fa, #c2f6fb); /* Colorful gradient */
        margin: 10% auto;
        padding: 20px;
        border-radius: 20px;
        width: 400px;
        text-align: center;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        animation: popIn 0.3s ease-out;
    }
    .modal-content h2 {
        margin-bottom: 20px;
        color: #343a40;
        font-size: 2em;
        font-weight: bold;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
    }
    .modal-content label {
        display: block;
        margin-bottom: 5px;
        font-size: 1em;
        color: #fff;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
        text-align: left;
    }
    .modal-content input {
        width: 100%;
        padding: 10px;
        margin-bottom: 15px;
        border: none;
        border-radius: 8px;
        font-size: 1em;
        box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.2);
    }
    .modal-content button {
        background: linear-gradient(45deg, #42e695, #3bb2b8); /* Gradient button */
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 25px;
        font-size: 1em;
        font-weight: bold;
        cursor: pointer;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .modal-content button:hover {
        transform: scale(1.05);
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    }
    .close {
        color: #fff;
        float: right;
        font-size: 24px;
        font-weight: bold;
        cursor: pointer;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
    }
    .close:hover,
    .close:focus {
        color: #ff6f61;
        text-decoration: none;
    }
    @keyframes popIn {
        from {
            transform: scale(0.8);
            opacity: 0;
        }
        to {
            transform: scale(1);
            opacity: 1;
        }
    }
</style>


<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container">
        <a class="navbar-brand" href="/">
            <img src="/img/logo.png" class="navbar-logo" alt="Gussr Logo">
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-auto">
                <li class="nav-item"><a class="nav-link" href="/">Hjem</a></li>
                <li class="nav-item"><a class="nav-link" href="#">Leaderboard</a></li>
                <li class="nav-item"><a class="nav-link" href="/about">Om os</a></li>
                <li class="nav-item"><a id="login-link" class="btn btn-success" href="#">Log ind</a></li>
                <li class="nav-item" style="display: none;"><a id="admin-link" class="nav-link" href="/adminpanel">Admin Panel</a></li>
                <li class="nav-item" style="display: none;"><a id="logout-link" class="btn btn-danger" href="#">Log ud</a></li>
            </ul>
        </div>
    </div>
</nav>

<!-- Login Modal -->
<div id="loginModal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h2>Log ind</h2>
        <form id="loginForm">
            <div>
                <label for="username">Brugernavn:</label><br>
                <input type="text" id="username" name="username" required>
            </div>
            <div>
                <label for="password">Adgangskode:</label><br>
                <input type="password" id="password" name="password" required>
            </div>
            <div style="margin-top: 15px;">
                <button type="submit">Log ind</button>
            </div>
        </form>
    </div>
</div>

<script>
    $(document).ready(function () {
        // Show login modal when login button is clicked
        $('#login-link').on('click', function (e) {
            e.preventDefault();
            $('#loginModal').css('display', 'block');
        });

        // Close modal when 'x' is clicked
        $('.close').on('click', function () {
            $('#loginModal').css('display', 'none');
        });

        // Close modal when clicking outside the modal
        $(window).on('click', function (event) {
            if ($(event.target).is('#loginModal')) {
                $('#loginModal').css('display', 'none');
            }
        });

        // Handle login form submission
        $('#loginForm').on('submit', function (e) {
            e.preventDefault();
            const username = $('#username').val();
            const password = $('#password').val();

            if (username === '' || password === '') {
                alert('Please enter both username and password.');
                return;
            }

            // Perform login request to backend API
            $.ajax({
                url: '/api/login',
                type: 'POST',
                data: { username, password },
                success: function (response) {
                    console.log(response);  // Debugging log for response
                    alert(response);  // Display server response
                    $('#loginModal').css('display', 'none'); // Close modal

                    // Store the role in sessionStorage
                    sessionStorage.setItem('role', response); // Store role (either 'user' or 'admin')
                    sessionStorage.setItem('isLoggedIn', 'true');  // Store login status
                    updateLoginStatus(); // Update UI based on login status and role
                    redirectBasedOnRole(response);  // Redirect based on user role
                },
                error: function (xhr) {
                    console.log('Login failed', xhr.responseText);  // Debugging log for error
                    alert('Login failed: ' + xhr.responseText);
                }
            });
        });

        // Update the UI based on login status
        function updateLoginStatus() {
            const isLoggedIn = sessionStorage.getItem('isLoggedIn');
            const role = sessionStorage.getItem('role');

            if (isLoggedIn === 'true') {
                $('#login-link').hide(); // Hide login button
                $('#logout-link').show(); // Show logout button
                if (role === 'ADMIN') {
                    $('#admin-link').show(); // Show admin panel link
                } else {
                    $('#admin-link').hide(); // Hide admin panel link for users
                }
            } else {
                $('#login-link').show(); // Show login button
                $('#logout-link').hide(); // Hide logout button
                $('#admin-link').hide(); // Hide admin panel link
            }
        }

        // Redirect user based on their role
        function redirectBasedOnRole(role) {
            if (role === 'ADMIN') {
                window.location.href = '/admin'; // Redirect admin to admin page
            } else if (role === 'USER') {
                window.location.href = '/'; // Redirect user to homepage
            }
        }


        // Handle logout
        $('#logout-link').on('click', function (e) {
            e.preventDefault();
            sessionStorage.removeItem('isLoggedIn'); // Remove login status from sessionStorage
            sessionStorage.removeItem('role'); // Remove role from sessionStorage
            updateLoginStatus(); // Update UI after logout
            alert('Du er hermed logget ud.'); // Alert the user
            window.location.href = '/'; // Redirect to homepage after logout
        });

        // Initial status check on page load
        updateLoginStatus();
    });
</script>


